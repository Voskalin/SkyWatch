<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SkyWatch - Fixed</title>
<style>

body {
        font-family:'Segoe UI', Tahoma, Verdana, sans-serif;
        text-align: center;
        margin-top: 20px;
        margin-bottom: 20px;
        padding: 20px 0 60px 0;
        min-height: 100vh;
        background: linear-gradient(135deg, #71ffff, #edffff);
        transition: background 1s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    h2 {
        font-size: 6rem;
        color: blue;
        margin: 10px 0 6px 0;
        text-shadow: 2px 2px 10px rgba(0,0,255,0.12);
    }
    p.lead {
        font-size: 20px;
        margin: 8px 0 18px 0;
        color: #003b59;
    }

    /* ahh yess please oil me up diddy */
    .controls-row {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        margin-top: 16px;
    }

    input#cityInput {
        padding: 12px 16px;
        width: 420px;
        font-size: 20px;
        border: 2px solid #00aaff;
        border-radius: 8px;
        outline: none;
        transition: all .25s ease;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }
    input#cityInput:focus {
        border-color: #0077cc;
        box-shadow: 0 0 10px rgba(0,123,255,0.15);
    }

    button {
        background-color: rgb(118, 194, 220);
        border: 2px solid #00aaff;
        border-radius: 8px;
        padding: 10px 18px;
        font-size: 18px;
        cursor: pointer;
        font-family:'Segoe UI', Tahoma, Verdana, sans-serif;
        transition: transform .18s ease, box-shadow .18s ease, background-color .18s ease;
    }
    button:hover {
        background-color: #00aaff;
        color: white;
        transform: scale(1.06);
        box-shadow: 0 8px 22px rgba(0,160,255,0.16);
    }

    h4.footer {
        margin-top: 26px;
        font-size: 16px;
        color: #003b59;
        opacity: 0.65;
    }

    /* glassmorphism yes yes */
    #weatherResult, #forecastResult {
        margin-top: 22px;
        margin-left: 150px;
        padding: 18px;
        border-radius: 10px;
        background: rgba(255,255,255,0.65);
        box-shadow: 0 8px 24px rgba(2,60,80,0.06);
        width: 640px;
        max-width: calc(100% - 40px);
        backdrop-filter: blur(6px);
        transition: opacity .4s ease, transform .35s ease;
        opacity: 0;
        transform: translateY(6px);
        align-items: center;
        text-align: justify;
        justify-content: center;
    }
    #weatherResult.show, #forecastResult.show { opacity: 1; transform: translateY(0); }

    /* some like dekorativ sky elements */
    .sky-stage {
        position: fixed;
        top: 8px;
        left: 0;
        right: 0;
        height: 260px;
        pointer-events: none;
        z-index: 0;
        overflow: visible;
    }
    .sky-svg { width: 100%; height: 100%; display: block; }

    /* Cloud anim */
    .cloud-anim {
        position: absolute;
        filter: drop-shadow(0 8px 18px rgba(0,0,0,0.06));
        opacity: 0.95;
    }
    .cloud-a { left: -380px; top: 24px; width: 480px; animation: cloudMove 65s linear infinite; }
    .cloud-b { left: -500px; top: 96px; width: 360px; animation: cloudMove 58s linear infinite; animation-delay: 9s; }
    .cloud-c { left: -200px; top: 148px; width: 320px; animation: cloudMove 72s linear infinite; animation-delay: 4s; }
    @keyframes cloudMove { from { transform: translateX(0); } to { transform: translateX(1900px); } }

    /* Sun pulse */
    .sun-anim { position: absolute; right: 12%; top: 26px; width: 120px; filter: drop-shadow(0 10px 30px rgba(255,180,60,0.12)); animation: sunPulse 6s ease-in-out infinite; }
    @keyframes sunPulse { 0% { transform: scale(0.98); } 50% { transform: scale(1.06); } 100% { transform: scale(0.98); } }

    /* Rain layer */
    .rain-layer { position: fixed; left: 0; top: 0; width:100%; height:100vh; pointer-events:none; z-index:1; opacity:0; transition:opacity .6s ease; }
    .rain-layer.show { opacity: 1; }
    .raindrop { position: absolute; width:18px; height:28px; animation: fall 1.2s linear infinite; }
    @keyframes fall { 0% { transform: translateY(-30px); opacity:0; } 20% { opacity:1; } 100% { transform: translateY(780px); opacity:0; } }

    /* assure main content is above sky stage visuals */
    .content {
        position: relative;
        z-index: 10;
        width: 100%;
        max-width: 980px;
        display: block;
    }

    /* desktop ahh yess i want more */
    @media (max-width: 900px) {
        h2 { font-size: 3.4rem; }
        input#cityInput { width: 72vw; }
        .sun-anim { display: none; }
    }
</style>
</head>
<body>
    <!--
        I LOVE HER AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA:
        
    -->

    <!-- Decorative sky visuals flat soft semi-realistic -->
    <div class="sky-stage" aria-hidden="true">
        <!-- Inline SVG assets: cloud, sun, raindrop. These are embedded so singlefile works. -->
        <div class="cloud-anim cloud-a" aria-hidden="true">
            <svg viewBox="0 0 800 400" class="sky-svg" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="gCloud" x1="0" x2="1">
                        <stop offset="0" stop-color="#ffffff" stop-opacity="0.98"/>
                        <stop offset="1" stop-color="#e6f9ff" stop-opacity="0.92"/>
                    </linearGradient>
                    <filter id="blurCloud" x="-20%" y="-20%" width="140%" height="140%">
                        <feGaussianBlur stdDeviation="8" result="b"/>
                        <feBlend in="SourceGraphic" in2="b"/>
                    </filter>
                </defs>
                <g filter="url(#blurCloud)">
                    <ellipse cx="260" cy="200" rx="200" ry="90" fill="url(#gCloud)"/>
                    <ellipse cx="420" cy="180" rx="140" ry="80" fill="url(#gCloud)"/>
                    <ellipse cx="140" cy="180" rx="120" ry="70" fill="url(#gCloud)"/>
                </g>
            </svg>
        </div>

        <div class="cloud-anim cloud-b" aria-hidden="true">
            <svg viewBox="0 0 800 400" class="sky-svg" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="gCloud2" x1="0" x2="1">
                        <stop offset="0" stop-color="#ffffff" stop-opacity="0.95"/>
                        <stop offset="1" stop-color="#eafcff" stop-opacity="0.9"/>
                    </linearGradient>
                    <filter id="blurCloud2" x="-20%" y="-20%" width="140%" height="140%">
                        <feGaussianBlur stdDeviation="6" result="b"/>
                        <feBlend in="SourceGraphic" in2="b"/>
                    </filter>
                </defs>
                <g filter="url(#blurCloud2)">
                    <ellipse cx="260" cy="220" rx="180" ry="86" fill="url(#gCloud2)"/>
                    <ellipse cx="420" cy="200" rx="120" ry="64" fill="url(#gCloud2)"/>
                    <ellipse cx="140" cy="200" rx="100" ry="56" fill="url(#gCloud2)"/>
                </g>
            </svg>
        </div>

        <div class="cloud-anim cloud-c" aria-hidden="true">
            <svg viewBox="0 0 800 400" class="sky-svg" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <linearGradient id="gCloud3" x1="0" x2="1">
                        <stop offset="0" stop-color="#ffffff" stop-opacity="0.94"/>
                        <stop offset="1" stop-color="#e6f9ff" stop-opacity="0.86"/>
                    </linearGradient>
                    <filter id="blurCloud3" x="-20%" y="-20%" width="140%" height="140%">
                        <feGaussianBlur stdDeviation="7" result="b"/>
                        <feBlend in="SourceGraphic" in2="b"/>
                    </filter>
                </defs>
                <g filter="url(#blurCloud3)">
                    <ellipse cx="240" cy="180" rx="160" ry="80" fill="url(#gCloud3)"/>
                    <ellipse cx="380" cy="160" rx="120" ry="64" fill="url(#gCloud3)"/>
                    <ellipse cx="120" cy="160" rx="90" ry="50" fill="url(#gCloud3)"/>
                </g>
            </svg>
        </div>

        <!-- Sun yellow niggers -->
        <div class="sun-anim" aria-hidden="true">
            <svg viewBox="0 0 400 400" class="sky-svg" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <radialGradient id="sunGrad" cx="50%" cy="40%" r="60%">
                        <stop offset="0%" stop-color="#fff7c2"/>
                        <stop offset="50%" stop-color="#ffe38a"/>
                        <stop offset="100%" stop-color="#ffd05a"/>
                    </radialGradient>
                    <filter id="sunGlow" x="-50%" y="-50%" width="200%" height="200%">
                        <feGaussianBlur stdDeviation="12" result="glow"/>
                        <feMerge><feMergeNode in="glow"/><feMergeNode in="SourceGraphic"/></feMerge>
                    </filter>
                </defs>
                <g filter="url(#sunGlow)">
                    <circle cx="200" cy="150" r="80" fill="url(#sunGrad)"/>
                </g>
            </svg>
        </div>

        <!-- Rain layer (populated dynamically) -->
        <div class="rain-layer" id="rainLayer" aria-hidden="true"></div>
    </div>

    <!-- pls keep the old layout -->
    <div class="content" role="main" aria-live="polite">
        <h2>SkyWatch</h2>

        <p class="lead">The Ultimate Weather Website</p>

        <div style="display:flex; justify-content:center; align-items:center; gap:12px; margin-top:6px;">
            <input id="cityInput" type="text" placeholder="Enter City name l" />
            <div class="controls-row" role="group" aria-label="controls">
            </div>
        </div>

        
    <div class="controls-row" role="group" aria-label="controls">
        <button id="checkBtn" type="button">Search</button>
        <button id="forecastBtn" type="button">Forecast</button>
        <button id="resetBtn">Reset</button>
    </div>

        <div id="weatherResult" aria-live="polite"></div>
        <div id="forecastResult" aria-live="polite"></div>

        <h4 class="footer">2025</h4>
    </div>
    
<script>
/* 
    legacy comments
    // Jesslyn
    // Agra bugis botak
    // Aku pengen punya adek perempuan
    // timestamp (second)
    // ncjdbsjcsdkbckbdsc
    // hgyguyguyguyfsweawaasufyuf
    // hdckdbj
*/

const apiKey = '84fad12ac2bdf783ee4c3c9095073990';
function el(id) { return document.getElementById(id); }

/* fetch thing */
async function fetchWeather(city) {
    const url = 'https://api.openweathermap.org/data/2.5/weather?q=' + encodeURIComponent(city) + '&appid=' + apiKey + '&units=metric&lang=en';
    const res = await fetch(url);
    if (!res.ok) throw new Error('City not found');
    return await res.json();
}

async function fetchForecast(city) {
    const url = 'https://api.openweathermap.org/data/2.5/forecast?q=' + encodeURIComponent(city) + '&appid=' + apiKey + '&units=metric&lang=en';
    const res = await fetch(url);
    if (!res.ok) throw new Error('City not found');
    return await res.json();
}

/* winDir */
function getWindDirection(deg) {
    const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
    return directions[Math.round(deg / 45) % 8];
}

function formatTime(unixTimestamp, timezoneOffset) {

    const date = new Date((unixTimestamp + timezoneOffset) * 1000);
    const hh = String(date.getUTCHours()).padStart(2,'0');
    const mm = String(date.getUTCMinutes()).padStart(2,'0');
    return hh + ':' + mm;
}

/*background, sun opacity, rain spawn*/
function changeVisuals(weatherMain) {
    const body = document.body;
    const rainLayer = el('rainLayer');
    const sun = document.querySelector('.sun-anim');

    if (!weatherMain) {
        body.style.background = 'linear-gradient(135deg, #71ffff, #edffff)';
        rainLayer.classList.remove('show');
        if (sun) sun.style.opacity = 0.95;
        return;
    }

    const w = weatherMain.toLowerCase();
    if (w.includes('cloud')) {
        body.style.background = 'linear-gradient(to right, #d7d2cc, #304352)';
        rainLayer.classList.remove('show');
        if (sun) sun.style.opacity = 0.25;
    } else if (w.includes('rain') || w.includes('drizzle')) {
        body.style.background = 'linear-gradient(to right, #3b3e66, #8f94fb)';
        rainLayer.classList.add('show');
        if (sun) sun.style.opacity = 0.3;
        spawnRain(20);
    } else if (w.includes('clear')) {
        body.style.background = 'linear-gradient(to right, #56ccf2, #2f80ed)';
        rainLayer.classList.remove('show');
        if (sun) sun.style.opacity = 1;
    } else if (w.includes('snow')) {
        body.style.background = 'linear-gradient(to right, #e0eafc, #cfdef3)';
        rainLayer.classList.remove('show');
        if (sun) sun.style.opacity = 0.85;
    } else if (w.includes('thunder')) {
        body.style.background = 'linear-gradient(to right, #141e30, #243b55)';
        rainLayer.classList.add('show');
        if (sun) sun.style.opacity = 0.05;
        spawnRain(28);
    } else if (w.includes('mist') || w.includes('fog') || w.includes('haze')) {
        body.style.background = 'linear-gradient(to right, #636363, #a2ab58)';
        rainLayer.classList.remove('show');
        if (sun) sun.style.opacity = 0.35;
    } else {
        body.style.background = 'linear-gradient(135deg, #71ffff, #edffff)';
        rainLayer.classList.remove('show');
        if (sun) sun.style.opacity = 0.95;
    }
}

/* Spawn semirandom raindrop elements inside rainlayer */
function spawnRain(count = 12) {
    const rainLayer = el('rainLayer');
    rainLayer.innerHTML = ''; // clear previous
    for (let i = 0; i < count; i++) {
        const img = document.createElement('svg');
        img.setAttribute('viewBox','0 0 80 120');
        img.setAttribute('class','raindrop');
        img.style.left = (6 + Math.random()*88) + '%';
        img.style.top = (-40 - Math.random()*120) + 'px';
        img.style.width = (10 + Math.random()*22) + 'px';
        img.style.animationDelay = (Math.random()*0.9) + 's';
        img.innerHTML = '<defs><linearGradient id="rGrad' + i + '" x1="0" x2="0" y1="0" y2="1"><stop offset="0" stop-color="#bde8ff"/><stop offset="1" stop-color="#6fcff6"/></linearGradient></defs>' +
                        '<path d="M40 0 C20 30 10 60 40 100 C70 60 60 30 40 0 Z" fill="url(#rGrad' + i + ')"/>';
        rainLayer.appendChild(img);
    }
}

/*displaying the nigger's data*/
async function renderWeather(city) {
    try {
        const data = await fetchWeather(city);

        // Agra bugis botak
        // Aku pengen punya adek perempuan
        const windSpeed = data.wind?.speed ?? 'N/A';
        const windDeg = data.wind?.deg ?? 0;
        const sunrise = data.sys?.sunrise;
        const sunset = data.sys?.sunset;
        const timezoneOffset = data.timezone ?? 0;

        const windDir = getWindDirection(windDeg);
        const sunriseTime = sunrise ? formatTime(sunrise, timezoneOffset) : 'N/A';
        const sunsetTime = sunset ? formatTime(sunset, timezoneOffset) : 'N/A';

        const weatherMain = (data.weather && data.weather[0] && data.weather[0].main) ? data.weather[0].main.toLowerCase() : '';
        changeVisuals(weatherMain);

        // if rainy, spawn raindrops
        if (weatherMain.includes('rain') || weatherMain.includes('drizzle')) {
            spawnRain(20);
        }

        const html = `
            <div style="display:flex; gap:12px; align-items:center; justify-content:space-between;">
                <div style="flex:1;">
                    <h3 style="margin:0 0 8px 0;">Weather in ${data.name}</h3>
                    <p style="margin:6px 0;">ðŸŒ¡ Temp: ${data.main.temp}Â°C</p>
                    <p style="margin:6px 0;">ðŸŒ¤ ${data.weather[0].description}</p>
                    <p style="margin:6px 0;">ðŸ’§ Humidity: ${data.main.humidity}%</p>
                    <p style="margin:6px 0;">ðŸ’¨ Wind: ${windSpeed} m/s (${windDir})</p>
                    <p class="small" style="margin-top:8px; color:#333; opacity:0.85;">ðŸŒ… Sunrise: ${sunriseTime} Â· ðŸŒ‡ Sunset: ${sunsetTime}</p>
                </div>
                <div style="width:140px; text-align:right;">
                    <!-- small decorative cloud image (inline SVG) -->
                    <svg viewBox="0 0 800 400" style="width:120px; opacity:0.95; transform:translateY(-6px);" xmlns="http://www.w3.org/2000/svg">
                        <ellipse cx="260" cy="200" rx="200" ry="90" fill="#ffffff"/>
                        <ellipse cx="420" cy="180" rx="140" ry="80" fill="#f0fcff"/>
                        <ellipse cx="140" cy="180" rx="120" ry="70" fill="#f3feff"/>
                    </svg>
                </div>
            </div>
        `;

        el('weatherResult').innerHTML = html;
        el('weatherResult').classList.add('show');
        el('forecastResult').innerHTML = '';

    } catch (err) {
        el('weatherResult').innerHTML = `<p style="color:red;">${err.message}</p>`;
        el('weatherResult').classList.add('show');
        el('forecastResult').innerHTML = '';
    }
}

async function renderForecast(city) {
    try {
        const data = await fetchForecast(city);
        const list = data.list || [];
        const daily = list.filter(i => i.dt_txt && i.dt_txt.includes('12:00:00'));
        let html = `<h3 style="margin-top:0;">Forecast for ${data.city.name}</h3>`;
        daily.forEach(item => {
            const date = new Date(item.dt_txt);
            html += `<div style="margin-bottom:10px; padding:10px; border-radius:8px; background:rgba(255,255,255,0.72);">
                        <strong>${date.toLocaleDateString('en-GB')}</strong><br />
                        ðŸŒ¡ ${item.main.temp}Â°C â€” ${item.weather[0].description}
                     </div>`;
        });
        el('forecastResult').innerHTML = html;
        el('forecastResult').classList.add('show');
        el('weatherResult').innerHTML = '';
    } catch (err) {
        el('forecastResult').innerHTML = `<p style="color:red;">${err.message}</p>`;
        el('forecastResult').classList.add('show');
        el('weatherResult').innerHTML = '';
    }
}

/* --- UI wiring --- */
document.getElementById('checkBtn').addEventListener('click', function(){
    const city = el('cityInput').value.trim();
    if (!city) return alert('Please enter a city name');
    renderWeather(city);
});

document.getElementById('forecastBtn').addEventListener('click', function(){
    const city = el('cityInput').value.trim();
    if (!city) return alert('Please enter a city name');
    renderForecast(city);
});

document.getElementById('resetBtn').addEventListener('click', function(){
    el('cityInput').value = '';
    el('weatherResult').innerHTML = '';
    el('forecastResult').innerHTML = '';
    el('weatherResult').classList.remove('show');
    el('forecastResult').classList.remove('show');
    changeVisuals(null);
});

window.addEventListener('load', function(){
});
</script>
</body>
</html>